# âœ… HOÃ€N THÃ€NH: PHÃ‚N CÃ”NG BÃC SÄ¨ THá»¦ CÃ”NG

## ğŸ¯ TÃNH NÄ‚NG Má»šI

### **1. ThÃªm cá»™t "LOáº I KHÃM"**
- âœ… Hiá»ƒn thá»‹ trong báº£ng lá»‹ch háº¹n
- âœ… PhÃ¢n biá»‡t: "KhÃ¡m thÆ°á»ng" vs "KhÃ¡m theo gÃ³i"
- âœ… Icon + mÃ u sáº¯c khÃ¡c nhau

### **2. PhÃ¢n cÃ´ng bÃ¡c sÄ© thá»§ cÃ´ng**
- âœ… Admin/Receptionist cÃ³ thá»ƒ phÃ¢n cÃ´ng tá»«ng dá»‹ch vá»¥
- âœ… Chá»n: BÃ¡c sÄ© + NgÃ y + Giá»
- âœ… Form inline ngay táº¡i trang chi tiáº¿t gÃ³i khÃ¡m

---

## ğŸ“Š GIAO DIá»†N

### **Báº£ng lá»‹ch háº¹n - Cá»™t "LOáº I KHÃM":**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MÃƒ Lá»ŠCH | Bá»†NH NHÃ‚N | BÃC SÄ¨ | NGÃ€Y | GIá»œ | LOáº I KHÃM | LÃ DO â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ #PKG1   | huy le    | -      | ... | ... | ğŸ“¦ KhÃ¡m theo gÃ³i | ... â”‚
â”‚ APT262  | huy le    | BS. A  | ... | ... | ğŸ“¦ KhÃ¡m theo gÃ³i | ... â”‚
â”‚ APT001  | Nguyá»…n A  | BS. B  | ... | ... | ğŸ‘¨â€âš•ï¸ KhÃ¡m thÆ°á»ng  | ... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MÃ u sáº¯c:**
- ğŸŸ£ **KhÃ¡m theo gÃ³i:** `bg-purple-100 text-purple-800`
- ğŸ”µ **KhÃ¡m thÆ°á»ng:** `bg-blue-100 text-blue-800`

---

### **Form phÃ¢n cÃ´ng thá»§ cÃ´ng:**

```
Chi tiáº¿t GÃ³i khÃ¡m #1

ğŸ“‹ Danh sÃ¡ch dá»‹ch vá»¥ & lá»‹ch khÃ¡m (0/28 Ä‘Ã£ phÃ¢n cÃ´ng)

1. Chá»¥p X quang ngá»±c tháº³ng sá»‘ hÃ³a II (phim)
   â° ChÆ°a phÃ¢n cÃ´ng bÃ¡c sÄ©
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ BÃ¡c sÄ©: [Dropdown]                      â”‚
   â”‚ NgÃ y:   [Date picker]                   â”‚
   â”‚ Giá»:    [Time dropdown]                 â”‚
   â”‚                         [PhÃ¢n cÃ´ng] â¤   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. SiÃªu Ã¢m á»• bá»¥ng...
   âœ… ÄÃ£ phÃ¢n cÃ´ng
   BÃ¡c sÄ©: BS. Tráº§n Thá»‹ B
   NgÃ y: 13/11/2025
   Giá»: 16:00
```

---

## ğŸ”§ CÃCH Sá»¬ Dá»¤NG

### **BÆ°á»›c 1: VÃ o chi tiáº¿t gÃ³i khÃ¡m**
```
Admin â†’ /package-appointments/1
```

### **BÆ°á»›c 2: TÃ¬m dá»‹ch vá»¥ chÆ°a phÃ¢n cÃ´ng**
```
Scroll xuá»‘ng â†’ Tháº¥y dá»‹ch vá»¥ cÃ³ ná»n vÃ ng "ChÆ°a phÃ¢n cÃ´ng bÃ¡c sÄ©"
```

### **BÆ°á»›c 3: Äiá»n form**
```
1. Chá»n bÃ¡c sÄ©: BS. Tráº§n Thá»‹ B - Tim máº¡ch
2. Chá»n ngÃ y: 13/11/2025
3. Chá»n giá»: 16:00
4. Click "PhÃ¢n cÃ´ng"
```

### **BÆ°á»›c 4: XÃ¡c nháº­n**
```
âœ… "PhÃ¢n cÃ´ng bÃ¡c sÄ© thÃ nh cÃ´ng"
â†’ Dá»‹ch vá»¥ chuyá»ƒn sang ná»n xanh "ÄÃ£ phÃ¢n cÃ´ng"
â†’ Hiá»ƒn thá»‹ thÃ´ng tin bÃ¡c sÄ©, ngÃ y, giá»
```

---

## ğŸ’» CODE

### **1. View - Cá»™t "LOáº I KHÃM":**

```php
// appointments/index.php

<th>Loáº¡i khÃ¡m</th>

...

<td>
    <?php if ($isPackageAppointment): ?>
        <span class="bg-purple-100 text-purple-800">
            <i class="fas fa-box-open"></i> KhÃ¡m theo gÃ³i
        </span>
    <?php else: ?>
        <span class="bg-blue-100 text-blue-800">
            <i class="fas fa-user-md"></i> KhÃ¡m thÆ°á»ng
        </span>
    <?php endif; ?>
</td>
```

---

### **2. View - Form phÃ¢n cÃ´ng:**

```php
// package_appointments/show.php

<?php if (!$hasAppointment): ?>
<form action="/package-appointments/assign-doctor" method="POST">
    <input type="hidden" name="package_appointment_id" value="<?= $id ?>">
    <input type="hidden" name="service_name" value="<?= $service['service_name'] ?>">
    
    <select name="doctor_id" required>
        <option value="">-- Chá»n bÃ¡c sÄ© --</option>
        <?php foreach ($doctors as $doctor): ?>
        <option value="<?= $doctor['id'] ?>">
            <?= $doctor['full_name'] ?> - <?= $doctor['specialization'] ?>
        </option>
        <?php endforeach; ?>
    </select>
    
    <input type="date" name="appointment_date" required>
    
    <select name="appointment_time" required>
        <?php for ($h = 8; $h < 17; $h++): ?>
            <?php for ($m = 0; $m < 60; $m += 30): ?>
                <option value="<?= sprintf('%02d:%02d', $h, $m) ?>">
                    <?= sprintf('%02d:%02d', $h, $m) ?>
                </option>
            <?php endfor; ?>
        <?php endfor; ?>
    </select>
    
    <button type="submit">PhÃ¢n cÃ´ng</button>
</form>
<?php endif; ?>
```

---

### **3. Controller - Xá»­ lÃ½ phÃ¢n cÃ´ng:**

```php
// PackageAppointmentController::assignDoctor()

public function assignDoctor() {
    Auth::requireLogin();
    
    $packageAppointmentId = $_POST['package_appointment_id'];
    $doctorId = $_POST['doctor_id'];
    $appointmentDate = $_POST['appointment_date'];
    $appointmentTime = $_POST['appointment_time'];
    
    // Láº¥y thÃ´ng tin gÃ³i khÃ¡m
    $packageAppointment = $this->packageAppointmentModel->findById($packageAppointmentId);
    
    // Táº¡o appointment
    $this->appointmentModel->appointment_code = 'APT' . date('YmdHis') . rand(100, 999);
    $this->appointmentModel->patient_id = $packageAppointment['patient_id'];
    $this->appointmentModel->doctor_id = $doctorId;
    $this->appointmentModel->package_id = $packageAppointment['package_id'];
    $this->appointmentModel->package_appointment_id = $packageAppointmentId;
    $this->appointmentModel->appointment_date = $appointmentDate;
    $this->appointmentModel->appointment_time = $appointmentTime;
    $this->appointmentModel->appointment_type = 'package';
    $this->appointmentModel->reason = $_POST['service_name'];
    $this->appointmentModel->status = 'pending';
    
    if ($this->appointmentModel->create()) {
        $_SESSION['success'] = 'PhÃ¢n cÃ´ng bÃ¡c sÄ© thÃ nh cÃ´ng';
    }
    
    header('Location: /package-appointments/' . $packageAppointmentId);
}
```

---

## âœ… ÄÃƒ HOÃ€N THÃ€NH

1. âœ… ThÃªm cá»™t "LOáº I KHÃM" vÃ o báº£ng lá»‹ch háº¹n
2. âœ… Hiá»ƒn thá»‹ "KhÃ¡m thÆ°á»ng" vs "KhÃ¡m theo gÃ³i"
3. âœ… Form phÃ¢n cÃ´ng bÃ¡c sÄ© thá»§ cÃ´ng
4. âœ… Chá»n bÃ¡c sÄ©, ngÃ y, giá»
5. âœ… Táº¡o appointment khi submit
6. âœ… Hiá»ƒn thá»‹ thÃ´ng tin sau khi phÃ¢n cÃ´ng

---

## ğŸ“ FILES ÄÃƒ Sá»¬A

1. âœ… `appointments/index.php` - ThÃªm cá»™t "LOáº I KHÃM"
2. âœ… `package_appointments/show.php` - ThÃªm form phÃ¢n cÃ´ng
3. âœ… `PackageAppointmentController.php` - Method `assignDoctor()` Ä‘Ã£ cÃ³

---

## ğŸš€ TEST

**BÆ°á»›c 1:** VÃ o `/appointments`
- âœ… Tháº¥y cá»™t "LOáº I KHÃM"
- âœ… Tháº¥y "ğŸ“¦ KhÃ¡m theo gÃ³i" vÃ  "ğŸ‘¨â€âš•ï¸ KhÃ¡m thÆ°á»ng"

**BÆ°á»›c 2:** VÃ o `/package-appointments/1`
- âœ… Tháº¥y dá»‹ch vá»¥ chÆ°a phÃ¢n cÃ´ng
- âœ… Tháº¥y form: BÃ¡c sÄ© + NgÃ y + Giá»

**BÆ°á»›c 3:** Äiá»n form vÃ  submit
- âœ… Táº¡o appointment thÃ nh cÃ´ng
- âœ… Hiá»ƒn thá»‹ thÃ´ng tin bÃ¡c sÄ© Ä‘Ã£ phÃ¢n cÃ´ng

---

**REFRESH VÃ€ TEST NGAY!** ğŸ‰
